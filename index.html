<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <link rel="icon" href="icons/icon-192.png">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--bg-color);
      color: var(--text-color);
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    section {
      margin-bottom: 20px;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    .finance-columns {
      display: flex;
      align-items: stretch;
      border-left: 2px solid #ccc;
      border-right: 2px solid #ccc;
    }
    .finance-columns > div {
      width: 48%;
      padding: 0 10px;
    }
    .finance-divider {
      width: 2px;
      background: #ccc;
    }
    .finance-summary {
      text-align: center;
      margin-top: 10px;
    }
    input, select, button {
      margin: 5px;
      padding: 8px;
      border-radius: 4px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #333;
        --text-color: #fff;
      }
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg-color: #fff;
        --text-color: #333;
      }
    }
    @media (max-width: 600px) {
      .finance-columns {
        flex-direction: column;
        border-left: none;
        border-right: none;
      }
      .finance-columns > div {
        width: 100%;
      }
      .finance-divider {
        height: 2px;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <section id="state">
      <h2>–°–æ—Å—Ç–æ—è–Ω–∏–µ</h2>
      <select id="state-select">
        <option value="focus">‚öñÔ∏è –í —Ñ–æ–∫—É—Å–µ</option>
        <option value="fatigue">‚ö°Ô∏è –£—Å—Ç–∞–ª–æ—Å—Ç—å</option>
        <option value="uplift">üöÄ –ü–æ–¥—ä—ë–º</option>
      </select>
      <button onclick="updateState()">–û–±–Ω–æ–≤–∏—Ç—å</button>
    </section>

    <!-- –ü—Ä–∞–≤–∏–ª–æ –¥–Ω—è -->
    <section id="rule">
      <h2>–ü—Ä–∞–≤–∏–ª–æ –¥–Ω—è</h2>
      <p id="rule-text"></p>
      <input type="text" id="new-rule" placeholder="–ù–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ">
      <button onclick="addRule()">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ</button>
      <button onclick="nextRule()">–°–ª–µ–¥—É—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ</button>
    </section>

    <!-- –ü–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å -->
    <section id="plan">
      <h2>–ü–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å</h2>
      <input type="text" id="task-input" placeholder="–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞">
      <input type="time" id="reminder-time">
      <button onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <ul id="task-list"></ul>
    </section>

    <!-- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è -->
    <section id="reminders">
      <h2>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h2>
      <input type="time" id="reminder-time-input">
      <input type="text" id="reminder-text" placeholder="–¢–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è">
      <button onclick="addReminder()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <ul id="reminder-list"></ul>
    </section>

    <!-- –û–∫—Ä—É–∂–µ–Ω–∏–µ -->
    <section id="environment">
      <h2>–û–∫—Ä—É–∂–µ–Ω–∏–µ</h2>
      <input type="text" id="person-name" placeholder="–ò–º—è">
      <select id="person-status">
        <option value="loyal">–õ–æ—è–ª—å–Ω—ã–π</option>
        <option value="neutral">–ù–µ–π—Ç—Ä–∞–ª</option>
        <option value="enemy">–í—Ä–∞–≥</option>
        <option value="contract">–ö–æ–Ω—Ç—Ä–∞–∫—Ç</option>
      </select>
      <select id="person-tags" multiple>
        <option value="üí∞ –†–µ—Å—É—Ä—Å">üí∞ –†–µ—Å—É—Ä—Å</option>
        <option value="ü™® –ë–∞–ª–ª–∞—Å—Ç">ü™® –ë–∞–ª–ª–∞—Å—Ç</option>
        <option value="üß† –í–Ω—É—à–∞–µ–º—ã–π">üß† –í–Ω—É—à–∞–µ–º—ã–π</option>
        <option value="üó£Ô∏è –ë–æ–ª—Ç—É–Ω">üó£Ô∏è –ë–æ–ª—Ç—É–Ω</option>
        <option value="‚úùÔ∏è –†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–π">‚úùÔ∏è –†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–π</option>
        <option value="üß© –ú–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä">üß© –ú–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä</option>
        <option value="üß≤ –ó–∞–≤–∏—Å—Ç–ª–∏–≤—ã–π">üß≤ –ó–∞–≤–∏—Å—Ç–ª–∏–≤—ã–π</option>
        <option value="ü¶ä –•–∏—Ç—Ä—ã–π">ü¶ä –•–∏—Ç—Ä—ã–π</option>
      </select>
      <input type="number" id="person-karma" min="-100" max="100" step="10" value="0">
      <button onclick="addPerson()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <ul id="person-list"></ul>
    section>

    <!-- –§–∏–∑–æ -->
    <section id="fitness">
      <h2>–§–∏–∑–æ</h2>
      <input type="text" id="exercise-type" placeholder="–¢–∏–ø —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è">
      <input type="number" id="exercise-result" placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç">
      <button onclick="addExercise()">–ó–∞–ø–∏—Å–∞—Ç—å</button>
      <ul id="exercise-list"></ul>
      <canvas id="fitness-chart"></canvas>
    </section>

    <!-- –î–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã -->
    <section id="finance">
      <h2>–î–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã</h2>
      <input type="number" id="transaction-amount" placeholder="–°—É–º–º–∞">
      <select id="transaction-type">
        <option value="income">–î–æ—Ö–æ–¥</option>
        <option value="expense">–†–∞—Å—Ö–æ–¥</option>
      </select>
      <input type="text" id="transaction-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">
      <button onclick="addTransaction()">–ó–∞–ø–∏—Å–∞—Ç—å</button>
      <div class="finance-columns">
        <div>
          <h3>–î–æ—Ö–æ–¥—ã</h3>
          <ul id="income-list"></ul>
        </div>
        <div class="finance-divider"></div>
        <div>
          <h3>–†–∞—Å—Ö–æ–¥—ã</h3>
          <ul id="expense-list"></ul>
        </div>
      </div>
      <div class="finance-summary">
        <p id="finance-percentage"></p>
      </div>
      <button onclick="showFinanceLog()">–ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Å—å –ª–æ–≥</button>
      <canvas id="finance-chart"></canvas>
    </section>

    <!-- –ê—Ä—Ö–µ—Ç–∏–ø—ã -->
    <section id="archetypes">
      <h2>–ê—Ä—Ö–µ—Ç–∏–ø—ã</h2>
      <div id="questions"></div>
      <button onclick="submitArchetype()">–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å</button>
      <p id="archetype-result"></p>
      <button onclick="resetArchetype()">–°–±—Ä–æ—Å–∏—Ç—å</button>
    </section>

    <!-- –ö–∞—Ä—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ -->
    <section id="strategy">
      <h2>–ö–∞—Ä—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</h2>
      <input type="text" id="strategy-goal" placeholder="–¶–µ–ª—å">
      <input type="text" id="strategy-levers" placeholder="–†—ã—á–∞–≥–∏">
      <input type="text" id="strategy-resources" placeholder="–†–µ—Å—É—Ä—Å—ã">
      <input type="text" id="strategy-obstacles" placeholder="–ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è">
      <input type="text" id="strategy-mechanisms" placeholder="–ú–µ—Ö–∞–Ω–∏–∑–º—ã">
      <select id="strategy-people"></select>
      <select id="strategy-status">
        <option value="plan">–ü–ª–∞–Ω</option>
        <option value="in-progress">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</option>
        <option value="completed">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
        <option value="failed">–ü—Ä–æ–≤–∞–ª–≤–∞–Ω–æ</option>
      </select>
      <button onclick="addStrategy()">–î–æ–±–∞–≤–∏—Ç—å</button>
      <ul id="strategy-list"></ul>
    </section>

    <!-- –õ–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
    <section id="activity">
      <h2>–õ–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
      <button onclick="toggleActivityLog()">–ü–æ–∫–∞–∑–∞—Ç—å/–°–∫—Ä—ã—Ç—å</button>
      <ul id="activity-list" style="display: none;"></ul>
      <button onclick="undoLastAction()">–û—Ç–º–µ–Ω–∏—Ç—å</button>
      <canvas id="activity-chart"></canvas>
    </section>

    <!-- –¢–µ–Ω–µ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <section id="analytics">
      <h2>–¢–µ–Ω–µ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
      <button onclick="renderAnalytics()">–û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É</button>
      <div id="analytics-results"></div>
    </section>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <section id="settings">
      <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
      <input type="file" id="background-image" accept="image/*">
      <button onclick="setBackground()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ–Ω</button>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    function logActivity(action) {
      try {
        const activity = JSON.parse(localStorage.getItem('activityLog') || '[]');
        activity.push({ date: new Date().toISOString(), action });
        localStorage.setItem('activityLog', JSON.stringify(activity));
        renderActivity();
      } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:', e);
      }
    }

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ
    function initState() {
      const stateSelect = document.getElementById('state-select');
      const savedState = localStorage.getItem('userState') || 'focus';
      stateSelect.value = savedState;

      window.updateState = () => {
        const state = stateSelect.value;
        localStorage.setItem('userState', state);
        logActivity(`–ò–∑–º–µ–Ω–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: ${state}`);
        renderAnalytics();
      };
    }

    // –ü—Ä–∞–≤–∏–ª–æ –¥–Ω—è
    const defaultRules = [
      '–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–±–æ–π ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Å–µ–º',
      '–î–µ–ª–∞–π —Å–µ–≥–æ–¥–Ω—è —Ç–æ, —á—Ç–æ –º–æ–∂–µ—à—å –æ—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞',
      '–ö–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –∫ —Ü–µ–ª–∏',
      '–ë—É–¥—å –≥–∏–±–∫–∏–º, –Ω–æ –Ω–µ –ª–æ–º–∞–π—Å—è',
      '–°–∏–ª–∞ –≤ –ø—Ä–æ—Å—Ç–æ—Ç–µ',
      '–û—à–∏–±–∫–∏ ‚Äî —ç—Ç–æ —É—Ä–æ–∫–∏',
      '–î–µ–π—Å—Ç–≤—É–π, –∞ –Ω–µ –º–µ—á—Ç–∞–π',
      '–ë—É–¥—å –≥–æ—Ç–æ–≤ –∫ –ø–µ—Ä–µ–º–µ–Ω–∞–º',
      '–¶–µ–Ω–∏ –≤—Ä–µ–º—è, –æ–Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è',
      '–°–ª—É—à–∞–π –±–æ–ª—å—à–µ, –≥–æ–≤–æ—Ä–∏ –º–µ–Ω—å—à–µ'
    ];

    function initRule() {
      const ruleText = document.getElementById('rule-text');
      const newRuleInput = document.getElementById('new-rule');
      let rules = JSON.parse(localStorage.getItem('rules') || '[]').concat(defaultRules);
      let currentRuleIndex = 0;

      const displayRule = () => {
        ruleText.textContent = rules[currentRuleIndex] || '–ù–µ—Ç –ø—Ä–∞–≤–∏–ª';
      };

      window.addRule = () => {
        const newRule = newRuleInput.value.trim();
        if (newRule) {
          rules.push(newRule);
          localStorage.setItem('rules', JSON.stringify(rules));
          newRuleInput.value = '';
          displayRule();
          logActivity(`–î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ: ${newRule}`);
        }
      };

      window.nextRule = () => {
        currentRuleIndex = (currentRuleIndex + 1) % rules.length;
        displayRule();
        logActivity('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ');
      };

      displayRule();
    }

    // –ü–ª–∞–Ω –Ω–∞ –¥–µ–Ω—å
    function initPlan() {
      const taskInput = document.getElementById('task-input');
      const reminderTime = document.getElementById('reminder-time');
      const taskList = document.getElementById('task-list');
      let tasks = JSON.parse(localStorage.getItem('tasks') || '[]');

      const renderTasks = () => {
        taskList.innerHTML = '';
        tasks.forEach((task, index) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <input type="checkbox" ${task.completed ? 'checked' : ''} onchange="toggleTask(${index})">
            ${task.text} (${task.time || '–±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏'})
            <button onclick="deleteTask(${index})">‚ùå</button>
          `;
          taskList.appendChild(li);
        });
      };

      window.addTask = () => {
        const text = taskInput.value.trim();
        const time = reminderTime.value;
        if (text) {
          tasks.push({ text, time, completed: false, created: new Date().toISOString() });
          localStorage.setItem('tasks', JSON.stringify(tasks));
          taskInput.value = '';
          reminderTime.value = '';
          renderTasks();
          logActivity(`–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞: ${text}`);
          if (time) scheduleNotification(text, time);
        }
      };

      window.toggleTask = (index) => {
        tasks[index].completed = !tasks[index].completed;
        localStorage.setItem('tasks', JSON.stringify(tasks));
        renderTasks();
        logActivity(`–ó–∞–¥–∞—á–∞ "${tasks[index].text}" ${tasks[index].completed ? '–≤—ã–ø–æ–ª–Ω–µ–Ω–∞' : '–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞'}`);
      };

      window.deleteTask = (index) => {
        const taskText = tasks[index].text;
        tasks.splice(index, 1);
        localStorage.setItem('tasks', JSON.stringify(tasks));
        renderTasks();
        logActivity(`–£–¥–∞–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞: ${taskText}`);
      };

      function scheduleNotification(text, time) {
        const [hours, minutes] = time.split(':').map(Number);
        const now = new Date();
        const notificationTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
        const delay = notificationTime - now;
        if (delay > 0) {
          setTimeout(() => {
            if (Notification.permission === 'granted') {
              new Notification(text);
            }
          }, delay);
        }
      }

      renderTasks();
    }

    // –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
    function initReminders() {
      const reminderTimeInput = document.getElementById('reminder-time-input');
      const reminderTextInput = document.getElementById('reminder-text');
      const reminderList = document.getElementById('reminder-list');
      let reminders = JSON.parse(localStorage.getItem('reminders') || '[]');

      const renderReminders = () => {
        reminderList.innerHTML = '';
        reminders.forEach((reminder, index) => {
          const li = document.createElement('li');
          li.innerHTML = `${reminder.time} - ${reminder.text} <button onclick="deleteReminder(${index})">‚ùå</button>`;
          reminderList.appendChild(li);
        });
      };

      window.addReminder = () => {
        const time = reminderTimeInput.value;
        const text = reminderTextInput.value.trim();
        if (time && text) {
          reminders.push({ time, text });
          localStorage.setItem('reminders', JSON.stringify(reminders));
          reminderTimeInput.value = '';
          reminderTextInput.value = '';
          renderReminders();
          logActivity(`–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: ${text}`);
          scheduleNotification(text, time);
        }
      };

      window.deleteReminder = (index) => {
        const reminderText = reminders[index].text;
        reminders.splice(index, 1);
        localStorage.setItem('reminders', JSON.stringify(reminders));
        renderReminders();
        logActivity(`–£–¥–∞–ª–µ–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: ${reminderText}`);
      };

      function scheduleNotification(text, time) {
        const [hours, minutes] = time.split(':').map(Number);
        const now = new Date();
        const notificationTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
        const delay = notificationTime - now;
        if (delay > 0) {
          setTimeout(() => {
            if (Notification.permission === 'granted') {
              new Notification(text);
            }
          }, delay);
        }
      }

      renderReminders();

      if (Notification.permission !== 'granted') {
        Notification.requestPermission();
      }
    }

    // –û–∫—Ä—É–∂–µ–Ω–∏–µ
    function initEnvironment() {
      const personName = document.getElementById('person-name');
      const personStatus = document.getElementById('person-status');
      const personTags = document.getElementById('person-tags');
      const personKarma = document.getElementById('person-karma');
      const personList = document.getElementById('person-list');
      let people = JSON.parse(localStorage.getItem('people') || '[]');

      const renderPeople = () => {
        personList.innerHTML = '';
        people.forEach((person, index) => {
          const li = document.createElement('li');
          li.innerHTML = `
            ${person.name} (${person.status}, –ö–∞—Ä–º–∞: ${person.karma}, –ú–µ—Ç–∫–∏: ${person.tags.join(', ')})
            <button onclick="adjustKarma(${index}, 10)">+10</button>
            <button onclick="adjustKarma(${index}, -10)">-10</button>
            <button onclick="deletePerson(${index})">‚ùå</button>
          `;
          personList.appendChild(li);
        });
        updateStrategyPeopleSelect();
      };

      window.addPerson = () => {
        const name = personName.value.trim();
        const status = personStatus.value;
        const tags = Array.from(personTags.selectedOptions).map(opt => opt.value);
        const karma = parseInt(personKarma.value) || 0;
        if (name) {
          people.push({ name, status, tags, karma });
          localStorage.setItem('people', JSON.stringify(people));
          personName.value = '';
          personTags.value = '';
          personKarma.value = '0';
          renderPeople();
          logActivity(`–î–æ–±–∞–≤–ª–µ–Ω —á–µ–ª–æ–≤–µ–∫: ${name}`);
          renderAnalytics();
        }
      };

      window.adjustKarma = (index, change) => {
        people[index].karma = Math.max(-100, Math.min(100, people[index].karma + change));
        localStorage.setItem('people', JSON.stringify(people));
        renderPeople();
        logActivity(`–ò–∑–º–µ–Ω–µ–Ω–∞ –∫–∞—Ä–º–∞ –¥–ª—è ${people[index].name}: ${people[index].karma}`);
        renderAnalytics();
      };

      window.deletePerson = (index) => {
        const name = people[index].name;
        people.splice(index, 1);
        localStorage.setItem('people', JSON.stringify(people));
        renderPeople();
        logActivity(`–£–¥–∞–ª—ë–Ω —á–µ–ª–æ–≤–µ–∫: ${name}`);
        renderAnalytics();
      };

      renderPeople();
    }

    // –§–∏–∑–æ
    function initFitness() {
      const exerciseType = document.getElementById('exercise-type');
      const exerciseResult = document.getElementById('exercise-result');
      const exerciseList = document.getElementById('exercise-list');
      const fitnessChart = document.getElementById('fitness-chart').getContext('2d');
      let exercises = JSON.parse(localStorage.getItem('exercises') || '[]');
      let chart;

      const renderExercises = () => {
        exerciseList.innerHTML = '';
        exercises.forEach((exercise, index) => {
          const li = document.createElement('li');
          li.innerHTML = `${exercise.type}: ${exercise.result} (${new Date(exercise.date).toLocaleDateString()}) <button onclick="deleteExercise(${index})">‚ùå</button>`;
          exerciseList.appendChild(li);
        });
        updateFitnessChart();
      };

      window.addExercise = () => {
        const type = exerciseType.value.trim();
        const result = parseFloat(exerciseResult.value);
        if (type && !isNaN(result)) {
          exercises.push({ type, result, date: new Date().toISOString() });
          localStorage.setItem('exercises', JSON.stringify(exercises));
          exerciseType.value = '';
          exerciseResult.value = '';
          renderExercises();
          logActivity(`–î–æ–±–∞–≤–ª–µ–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: ${type}, ${result}`);
        }
      };

      window.deleteExercise = (index) => {
        const exerciseType = exercises[index].type;
        exercises.splice(index, 1);
        localStorage.setItem('exercises', JSON.stringify(exercises));
        renderExercises();
        logActivity(`–£–¥–∞–ª–µ–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: ${exerciseType}`);
      };

      function updateFitnessChart() {
        const types = [...new Set(exercises.map(ex => ex.type))];
        const datasets = types.map(type => ({
          label: type,
          data: exercises.filter(ex => ex.type === type).map(ex => ex.result),
          backgroundColor: `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 0.5)`
        }));

        if (chart) chart.destroy();
        chart = new Chart(fitnessChart, {
          type: 'bar',
          data: {
            labels: exercises.map(ex => new Date(ex.date).toLocaleDateString()),
            datasets
          },
          options: { scales: { y: { beginAtZero: true } } }
        });
      }

      renderExercises();
    }

    // –î–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã
    function initFinance() {
      const amountInput = document.getElementById('transaction-amount');
      const typeSelect = document.getElementById('transaction-type');
      const descriptionInput = document.getElementById('transaction-description');
      const incomeList = document.getElementById('income-list');
      const expenseList = document.getElementById('expense-list');
      const percentageText = document.getElementById('finance-percentage');
      const financeChart = document.getElementById('finance-chart').getContext('2d');
      let transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
      let chart;

      const renderTransactions = () => {
        incomeList.innerHTML = '';
        expenseList.innerHTML = '';
        